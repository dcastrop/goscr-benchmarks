(*# NestedProtocols #*)

nested protocol Ring (role P, role Q; new role R) {
  rec X {
    Next(int) from Q to R;
    continue X with {
      Last(int) from R to P;
      R calls Ring(P, R);
    };
  }
}

global protocol Main (role P, role Q) {
  rec X {
    Next(int) from P to Q;
    continue X with {
      Last(int) from Q to P;
      Q calls Ring(P, Q);
    };
  }
}
  
